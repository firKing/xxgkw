<?php /** 文件名:admin.php* 功能:老后台主体文件* 工作流程:* 1.判断是否登录，如果未登录，跳转至 login.php 进行处理* 2.如果已经登录，将通过 get 数组来显示 main frame 里操作的内容* 更新日志:* 2012.12.06	黄	恢复添加操作日志功能* 2012.10.28	黄	代码整理*/	error_reporting(E_ALL);	session_start();			define("ROOT_PATH", dirname(__FILE__)."/");	//定义根目录常量，末尾带斜杠，形式为 D:/www/admin/		require_once(ROOT_PATH."/inc/inc.php");	$db = new mysql();	//创建一个 mysql 对象	$administrator = new Admin();	//创建一个 Admin 对象	if (false == $administrator->isLogin()){	//判断是否登录		require_once(ROOT_PATH."admin/login.php");		exit();	}	$action = addslashes(@$_GET['action']);	if($action){		if(!file_exists($action.".php")){			$action	= "admin/index";		}		$sql = "SELECT * FROM `menu` WHERE `url`='".$action."'";		$query = $db->query($sql);		if(1 == $db->num_rows($query)){			if(1 != $administrator->checkRights("", $action)){				$message = "操作失败，原因：权限不够";				printMessage($message, "admin.php");				exit();			}		}		if($action != "admin/left"){			$administrator->addLog($action);	//点击菜单后，添加一条操作日志			require_once(ROOT_PATH."head.php");			require_once(ROOT_PATH.$action.".php");			require_once(ROOT_PATH."foot.php");		}else{			require_once(ROOT_PATH.$action.".php");					}		exit();	}?><html>	<head>		<title><?php echo $webName;?> - 管理后台</title>		<meta http-equiv="Content-Type" content="text/html; charset=gb2312">		<link rel="stylesheet" type="text/css" href="css/main.css">		<script><?php //自动最大化 ?>			self.moveTo(0,0);			self.resizeTo(screen.availWidth,screen.availHeight);		</script> 	</head>	<frameset rows="*" cols="165,*" framespacing="0" frameborder="1" border="false" id="frame" scrolling="yes">		<frame name="left" scrolling="auto" marginwidth="0" marginheight="0" src="admin.php?action=admin/left">		<frame name="main" scrolling="auto" src="admin.php?action=admin/index">	</frameset>	<noframes>		<body leftmargin="2" topmargin="0" marginwidth="0" marginheight="0">		<p>Please Use IE 5.0</p>		</body>	</noframes></html>